(()=>{"use strict";var e,t={513(e,t,n){const o=window.wp.blocks,a=window.wp.i18n,i=window.wp.blockEditor,r=window.wp.components,l=window.wp.element,s=window.wp.apiFetch;var c=n.n(s);const d=window.wp.primitives,m=window.ReactJSXRuntime;var g=(0,m.jsx)(d.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)(d.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),w=(0,m.jsx)(d.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,m.jsx)(d.Path,{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 4.5h14c.3 0 .5.2.5.5v8.4l-3-2.9c-.3-.3-.8-.3-1 0L11.9 14 9 12c-.3-.2-.6-.2-.8 0l-3.6 2.6V5c-.1-.3.1-.5.4-.5zm14 15H5c-.3 0-.5-.2-.5-.5v-2.4l4.1-3 3 1.9c.3.2.7.2.9-.1L16 12l3.5 3.4V19c0 .3-.2.5-.5.5z"})}),u=(0,m.jsx)(d.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)(d.Path,{d:"M16.5 7.5 10 13.9l-2.5-2.4-1 1 3.5 3.6 7.5-7.6z"})});const p=window.wp.data,f=JSON.parse('{"UU":"imagen-flow/generator"}');(0,o.registerBlockType)(f.UU,{edit:function({attributes:e,setAttributes:t,clientId:n}){const{images:s,hasGenerated:d}=e,[f,h]=(0,l.useState)(!1),[_,x]=(0,l.useState)("square"),[v,b]=(0,l.useState)(1),[j,y]=(0,l.useState)(!0),[k,C]=(0,l.useState)(""),[P,B]=(0,l.useState)(""),[S,O]=(0,l.useState)(null),{replaceBlocks:G}=(0,p.useDispatch)("core/block-editor"),{createErrorNotice:T,createSuccessNotice:V}=(0,p.useDispatch)("core/notices"),{postTitle:I,postContent:E}=(0,p.useSelect)(e=>{const t=e("core/editor");return{postTitle:t.getEditedPostAttribute("title"),postContent:t.getEditedPostAttribute("content")}},[]),H=async()=>{h(!0);try{let e=k;if(j){const t=await c()({path:"/imagen-flow/v1/summarize",method:"POST",data:{content:(I||"")+"\n"+(E?E.substring(0,1e3):"")}});if(!t.success)throw new Error(t.message||(0,a.__)("Failed to summarize content.","imagen-flow"));e=t.essence}if(!e)return T((0,a.__)("Please provide a prompt or some content.","imagen-flow")),void h(!1);const n=await c()({path:"/imagen-flow/v1/generate",method:"POST",data:{prompt:e,samples:v,orientation:_,filename_keyword:P}});if(n.success&&n.images&&n.images.length>0)t({images:[...s,...n.images],hasGenerated:!0}),V((0,a.__)("Images generated successfully!","imagen-flow"),{type:"snackbar"});else{const e=n.message||(0,a.__)("API returned success but no images were generated.","imagen-flow");T(e)}}catch(e){console.error("Generation failed",e);const t=e.message||(0,a.__)("An unknown error occurred during generation.","imagen-flow");T((0,a.__)("Generation failed: ","imagen-flow")+t)}finally{h(!1)}};return(0,m.jsxs)("div",{...(0,i.useBlockProps)(),children:[(0,m.jsx)(i.InspectorControls,{children:(0,m.jsxs)(r.PanelBody,{title:(0,a.__)("Generation Settings","imagen-flow"),children:[(0,m.jsx)(r.ToggleControl,{label:(0,a.__)("Auto-generate from article","imagen-flow"),checked:j,onChange:y}),!j&&(0,m.jsx)(r.TextareaControl,{label:(0,a.__)("Custom Prompt","imagen-flow"),placeholder:(0,a.__)("Enter custom prompt...","imagen-flow"),value:k,onChange:C}),(0,m.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,m.jsx)("label",{className:"components-base-control__label",children:(0,a.__)("Orientation","imagen-flow")}),(0,m.jsxs)(r.ButtonGroup,{style:{width:"100%",marginTop:"5px"},children:[(0,m.jsx)(r.Button,{isPrimary:"square"===_,onClick:()=>x("square"),style:{flex:1},children:(0,a.__)("Square","imagen-flow")}),(0,m.jsx)(r.Button,{isPrimary:"portrait"===_,onClick:()=>x("portrait"),style:{flex:1},children:(0,a.__)("Portrait","imagen-flow")}),(0,m.jsx)(r.Button,{isPrimary:"landscape"===_,onClick:()=>x("landscape"),style:{flex:1},children:(0,a.__)("Landscape","imagen-flow")})]})]}),(0,m.jsx)(r.RangeControl,{label:(0,a.__)("Quantity","imagen-flow"),value:v,onChange:b,min:1,max:4}),(0,m.jsx)(r.TextControl,{label:(0,a.__)("Naming Keyword (SEO)","imagen-flow"),help:(0,a.__)("Add a brand or specific keyword for the filename.","imagen-flow"),value:P,onChange:B}),(0,m.jsx)(r.Button,{isPrimary:!0,isBusy:f,onClick:H,disabled:f,style:{width:"100%",justifyContent:"center",marginTop:"10px"},children:f?(0,a.__)("Generating...","imagen-flow"):(0,a.__)("Generate Images","imagen-flow")})]})}),(0,m.jsx)(i.BlockControls,{children:(0,m.jsx)(r.ToolbarGroup,{children:(0,m.jsx)(r.ToolbarButton,{icon:g,label:(0,a.__)("Generate Image","imagen-flow"),onClick:H,disabled:f})})}),0===s.length&&!d&&(0,m.jsx)(r.Placeholder,{icon:w,label:(0,a.__)("ImagenFlow","imagen-flow"),instructions:(0,a.__)("Configure generation in the sidebar and click Generate.","imagen-flow"),children:(0,m.jsx)(r.Button,{isPrimary:!0,onClick:H,disabled:f,children:f?(0,m.jsx)(r.Spinner,{}):(0,a.__)("Generate from Essence","imagen-flow")})}),(0,m.jsx)("div",{className:"imagen-flow-gallery",children:s.map((e,t)=>(0,m.jsxs)("div",{className:"imagen-flow-thumbnail",children:[(0,m.jsx)("img",{src:e.url,alt:"",onClick:()=>O(e)}),(0,m.jsx)(r.Button,{icon:u,className:"insert-button",isPrimary:!0,onClick:t=>{t.stopPropagation(),(e=>{const t=(0,o.createBlock)("core/image",{id:e.id,url:e.url,alt:e.alt||"",caption:e.caption||""});G(n,t),V((0,a.__)("Image added to post as native block.","imagen-flow"),{type:"snackbar"})})(e)},label:(0,a.__)("Insert into post","imagen-flow")})]},t))}),S&&(0,m.jsxs)(r.Modal,{title:(0,a.__)("Preview Image","imagen-flow"),onRequestClose:()=>O(null),children:[(0,m.jsx)("img",{src:S.url,alt:"",style:{width:"100%"}}),(0,m.jsx)("div",{style:{marginTop:"10px",display:"flex",justifyContent:"flex-end"},children:(0,m.jsx)(r.Button,{isPrimary:!0,onClick:()=>O(null),children:(0,a.__)("Close","imagen-flow")})})]})]})},save:function(){return null}})}},n={};function o(e){var a=n[e];if(void 0!==a)return a.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,o),i.exports}o.m=t,e=[],o.O=(t,n,a,i)=>{if(!n){var r=1/0;for(d=0;d<e.length;d++){for(var[n,a,i]=e[d],l=!0,s=0;s<n.length;s++)(!1&i||r>=i)&&Object.keys(o.O).every(e=>o.O[e](n[s]))?n.splice(s--,1):(l=!1,i<r&&(r=i));if(l){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,a,i]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var a,i,[r,l,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in l)o.o(l,a)&&(o.m[a]=l[a]);if(s)var d=s(o)}for(t&&t(n);c<r.length;c++)i=r[c],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(d)},n=globalThis.webpackChunkimagen_flow=globalThis.webpackChunkimagen_flow||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=o.O(void 0,[350],()=>o(513));a=o.O(a)})();